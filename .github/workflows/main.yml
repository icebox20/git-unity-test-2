name: Merge

on:
  push:
    branches: 
      - william

jobs:

  build:

    runs-on: windows-latest

    steps:

    - uses: actions/checkout@v2
      with:
        ref: master

    - name: Install UnityYAMLMerge
      run: |
        git config --local merge.tool unityyamlmerge
        git config --local mergetool.unityyamlmerge.trustExitCode false
        git config --local mergetool.unityyamlmerge.cmd ""'<${{ github.workspace }}/.github/workflows/UnityYAMLMerge.exe>'  merge -p "$BASE" "$REMOTE" "$LOCAL" "$MERGED"""
        git config --list --show-origin
      shell: bash
        
    - name: Run a multi-line script
      run: |
        git fetch 
        git checkout ${GITHUB_REF##*/}
        echo ${GITHUB_REF##*/}
        git checkout develop
        git branch
        git merge ${GITHUB_REF##*/} --
        git status
      shell: bash

    - name: YAML Merge
      run: |
        git mergetool --tool=unityyamlmerge
        dir

    - name: Push changes
      uses: ad-m/github-push-action@master
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        branch: 'develop'